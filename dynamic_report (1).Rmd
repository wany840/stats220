---
title: My dynamic report
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)


```

```{css}


```


##Overview of the Data
In this report, we are analyzing a dataset of food delivery orders. The dataset contains information on different platforms used for ordering, the types of restaurants, total order amounts, and customer ratings.

We aim to explore key factors like delivery times, ratings, and the correlation between platform choices and customer satisfaction.

##Delivery Time Analysis
We begin by analyzing the average delivery time across different food delivery platforms.




```{r}
library(dplyr)
library(ggplot2)
csv_file <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vT85tuqou56HR6j0FuTWGawhNfTCGDaGe7RgXSSeoQdg7JTnu82uidUGYW7kVXI1DwdrldABk2jmdoI/pub?gid=0&single=true&output=csv"

logged_data <- read_csv(csv_file)

# Rename columns for easier understanding
latest_data <- logged_data %>%
  rename(
    Platform = `Which.food.delivery.platform.was.used.for.this.order.`,
    RestaurantType = `What.type.of.restaurant.was.this.order.from.`,
    TotalAmount = `What.was.the.total.amount.of.the.order...Currency..NZD.`,
    OrderTime = `Order.Time..Multiple.Choice.`,
    DeliveryTime = `How.many.minutes.did.it.take.from.ordering.to.delivery.`,
    DeliveryAttitude = `How.was.the.delivery.person.s.attitude.`,
    Rating = `X...How.would.you.rate.this.food.delivery.experience...1...Very.poor..10...Excellent...`
  )

# ---- Descriptive Statistics ----

# 1. Calculate the mean, median, and standard deviation of TotalAmount and DeliveryTime
mean_total_amount <- mean(latest_data$TotalAmount, na.rm = TRUE)
median_total_amount <- median(latest_data$TotalAmount, na.rm = TRUE)
sd_total_amount <- sd(latest_data$TotalAmount, na.rm = TRUE)

mean_delivery_time <- mean(latest_data$DeliveryTime, na.rm = TRUE)
median_delivery_time <- median(latest_data$DeliveryTime, na.rm = TRUE)
sd_delivery_time <- sd(latest_data$DeliveryTime, na.rm = TRUE)


# Average delivery time by platform
ggplot(latest_data, aes(x = Platform, y = DeliveryTime)) +
  stat_summary(fun = mean, geom = "bar", fill = "#FF5733") +
  labs(title = "Average Delivery Time by Platform", x = "Platform", y = "Average Delivery Time (Minutes)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


Customer Rating Analysis
Next, we analyze the average ratings across different platforms.

```{r}
# Average rating by platform
ggplot(latest_data, aes(x = Platform, y = Rating)) +
  stat_summary(fun = mean, geom = "bar", fill = "#4CAF50") +
  labs(title = "Average Rating by Platform", x = "Platform", y = "Average Rating") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))




```


## Dynamic Commentary Based on Data
Now, let's generate some dynamic commentary based on the data.

```{r}


# Text commentary for the fastest platform based on delivery time
fastest_platform <- latest_data %>%
  group_by(Platform) %>%
  summarise(mean_delivery_time = mean(DeliveryTime, na.rm = TRUE), .groups = "drop") %>%
  filter(mean_delivery_time == min(mean_delivery_time, na.rm = TRUE))

fastest_platform_text <- paste(
  "The platform with the fastest delivery time is:", paste(fastest_platform$Platform, collapse = ", "), 
  "with an average delivery time of", round(fastest_platform$mean_delivery_time[1], 1), "minutes."
)

# Text commentary for the highest rated platform
highest_rated_platform <- latest_data %>%
  group_by(Platform) %>%
  summarise(mean_rating = mean(Rating, na.rm = TRUE), .groups = "drop") %>%
  filter(mean_rating == max(mean_rating, na.rm = TRUE))

highest_rated_platform_text <- paste(
  "The platform with the highest average rating is:", paste(highest_rated_platform$Platform, collapse = ", "), 
  "with an average rating of", round(highest_rated_platform$mean_rating[1], 1), "."
)

fastest_platform_text
highest_rated_platform_text


```

##Conclusion
In conclusion, this report provides a thorough analysis of the food delivery dataset. We analyzed delivery times and customer ratings across platforms. Based on the data, we identified the platform with the fastest delivery time and the highest customer satisfaction.


